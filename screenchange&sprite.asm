;;;;;;;;;;;;;;;;;;;;;;;
;;;   iNES HEADER   ;;;
;;;;;;;;;;;;;;;;;;;;;;;

    .db  "NES", $1a     ;identification of the iNES header
    .db  PRG_COUNT      ;number of 16KB PRG-ROM pages
    .db  CHR_COUNT      ;number of 8KB CHR-ROM pages
    .db  $10|MIRRORING  ;mapper 0 and mirroring
    .dsb $09, $00       ;clear the remaining bytes

    .fillvalue $FF

;;;;;;;;;;;;;;;;;;;;;
;;;   VARIABLES   ;;;
;;;;;;;;;;;;;;;;;;;;;

    .enum $0000
    
screenPtr       .dsb 2
attributePtr    .dsb 2
itemPtr         .dsb 2
animationPtr    .dsb 2
collisionPtr    .dsb 2
chestHdrTblPtr  .dsb 2
chestHdrPtr     .dsb 2
textBoxPtr      .dsb 2

gameState       .dsb 1
softPPU_Control .dsb 1
softPPU_Mask    .dsb 1
prgNo           .dsb 1
prgNoOld        .dsb 1

metaTile        .dsb 1
rowCounter      .dsb 1
counter         .dsb 1
nametable       .dsb 1
needDraw        .dsb 1
needItems       .dsb 1

hrs             .dsb 1
mins            .dsb 1
secs            .dsb 1
tick            .dsb 1

sleeping        .dsb 1

buttons         .dsb 1
oldButtons      .dsb 1
moving          .dsb 1
upIsPressed     .dsb 1
downIsPressed   .dsb 1
leftIsPressed   .dsb 1
rightIsPressed  .dsb 1

playerDir       .dsb 1
playerDirOld    .dsb 1
playerSpeed     .dsb 2
playerX         .dsb 1
playerY         .dsb 1
playerY0        .dsb 1
playerY1        .dsb 1
playerX0        .dsb 1
playerX1        .dsb 1
spriteX         .dsb 1
spriteY         .dsb 1
spriteXpos      .dsb 1
spriteYpos      .dsb 1
chestY0         .dsb 1
chestY1         .dsb 1
chestX0         .dsb 1
chestX1         .dsb 1
messageNo		.dsb 1
chestNo         .dsb 1
chestHdrNo      .dsb 1
chestStrAddr    .dsb 1
BGtype          .dsb 1

itemFlagsTemp   .dsb 1
enemyFlagsTemp  .dsb 1
animationEnable .dsb 1
frameCounter    .dsb 2
animationNumber .dsb 1
animConstNumber .dsb 3

textCounter     .dsb 1
needTextAttrib  .dsb 1
textBoxActive   .dsb 1
restoreTB       .dsb 1
textBoxRows     .dsb 1
textIndirect    .dsb 1
textSpeed       .dsb 1
stringLength    .dsb 1
stringCtr       .dsb 1
lineNo          .dsb 1
textAddrL       .dsb 1
textAddrH       .dsb 1
temp            .dsb 1

    .ende

;;;;;;;;;;;;;;;;;;;;;
;;;   CONSTANTS   ;;;
;;;;;;;;;;;;;;;;;;;;;

PRG_COUNT       = 4       ;1 = 16KB, 2 = 32KB
CHR_COUNT       = 2
MIRRORING       = %0001   ;%0000 = horizontal, %0001 = vertical, %1000 = four-screen

PPU_Control     .equ $2000
PPU_Mask        .equ $2001
PPU_Status      .equ $2002
PPU_Scroll      .equ $2005
PPU_Address     .equ $2006
PPU_Data        .equ $2007

MAP_Control     .equ $8000
MAP_CHR0        .equ $A000
MAP_CHR1        .equ $C000
MAP_PRG         .equ $E000

spriteRAM       .equ $0204
itemRAM         .equ $0220
itemSoftFlags   .equ $6000
enemySoftFlags  .equ $6100
bkgBuffer       .equ $6200
atbBuffer       .equ $62E0

textBuffer      .equ $0400
textBoxStartL   .equ $41
textBoxStartH   .equ $20
itemNumBuff		.equ $0580

controller1     .equ $4016

;;;;;;;;;;;;;;;;;;;;;
;;;               ;;;
;;;   BANK ZERO   ;;;
;;;               ;;;
;;;;;;;;;;;;;;;;;;;;;

    .base $8000

bitMask:
    .db %00000001, %00000010, %000000100, %00001000, %00010000, %00100000, %01000000, %10000000

sprite1:
    .db $00,$06,%00000001,$00
    .db $00,$0E,%00000000,$00
    .db $00,$0E,%01000000,$00
    .db $00,$10,%00000000,$00
    .db $00,$10,%01000000,$00

spriteAnim:
    .db $06,$01, $02,$00, $03,$00, $12,$00, $13,$00
    .db $06,$01, $0E,$00, $0E,$40, $10,$00, $10,$40
    .db $06,$01, $03,$40, $02,$40, $13,$40, $12,$40

    .db $16,$01, $04,$00, $05,$00, $14,$00, $15,$00
    .db $16,$01, $01,$00, $01,$40, $11,$00, $11,$40
    .db $16,$01, $05,$40, $04,$40, $15,$40, $14,$40

    .db $07,$01, $08,$00, $09,$00, $18,$00, $19,$00
    .db $07,$01, $0A,$00, $0B,$00, $1A,$00, $1B,$00
    .db $07,$01, $0C,$00, $0D,$00, $1C,$00, $1D,$00

    .db $17,$01, $09,$40, $08,$40, $19,$40, $18,$40
    .db $17,$01, $0B,$40, $0A,$40, $1B,$40, $1A,$40
    .db $17,$01, $0D,$40, $0C,$40, $1D,$40, $1C,$40

animationConstants:
    .db $00,$0A,$14,$1E,$28,$32
    .db $3C,$46,$50,$5A,$64,$6E

palette:
    ;   BLK,WHT,LRd,DRd   BLK,DBL,LGr,DGr   BLK,WHT,LGr,DGr   BLK,DBL,RED,WHT
    .db $0F,$00,$10,$20,  $0F,$07,$06,$38,  $0F,$19,$29,$20,  $0F,$0C,$16,$30   ;;background palette
    .db $0F,$17,$00,$10,  $0F,$17,$28,$39,  $0F,$20,$10,$00,  $0F,$02,$38,$3C   ;;sprite palette

bkgL:
    .dl bkg00, bkg01, bkg02, bkg03, bkg04
    .dsb $0B,$00

    .dl bkg10, bkg11, bkg12, bkg13
    .dsb $0C,$00

    .dl bkg20, bkg21, bkg22, bkg23
    .dsb $0C,$00

    .dl bkg30, bkg31, bkg32, bkg33
    .dsb $0C,$00

bkgH:
    .dh bkg00, bkg01, bkg02, bkg03, bkg04
    .dsb $0B,$00

    .dh bkg10, bkg11, bkg12, bkg13
    .dsb $0C,$00

    .dh bkg20, bkg21, bkg22, bkg23
    .dsb $0C,$00

    .dh bkg30, bkg31, bkg32, bkg33
    .dsb $0C,$00
    
atbL:
    .dl atb00, atb01, atb02, atb03, atb04
    .dsb $0B,$00
    
    .dl atb10, atb11, atb12, atb13
    .dsb $0C,$00

    .dl atb20, atb21, atb22, atb23
    .dsb $0C,$00
    
    .dl atb30, atb31, atb32, atb33
    .dsb $0C,$00

atbH:
    .dh atb00, atb01, atb02, atb03, atb04
    .dsb $0B,$00
    
    .dh atb10, atb11, atb12, atb13
    .dsb $0C,$00
    
    .dh atb20, atb21, atb22, atb23
    .dsb $0C,$00
    
    .dh atb30, atb31, atb32, atb33
    .dsb $0C,$00

    .align $100

;;;;;;;;;;;;;;;;;;;;;
;;;   FIRST ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;

bkg00:
   .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
   .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
   .db $01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$01,$01,$01,$01,$01,$01,$01,$01,$05,$05,$05,$01
   .db $01,$05,$05,$05,$01,$02,$02,$01,$01,$02,$02,$01,$05,$05,$05,$02
   .db $01,$05,$05,$05,$02,$05,$05,$01,$01,$05,$05,$02,$05,$05,$05,$05
   .db $01,$05,$05,$05,$05,$05,$05,$02,$02,$05,$05,$05,$05,$05,$05,$05
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
   .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
   .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
   .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

bkg01:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$01,$02,$02,$02,$02,$02,$01,$01,$01,$01
    .db $01,$05,$05,$05,$05,$05,$01,$05,$05,$05,$05,$05,$01,$01,$01,$01
    .db $01,$05,$05,$05,$05,$05,$01,$05,$05,$05,$05,$05,$01,$01,$01,$01
    .db $02,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$01,$02,$02,$02
    .db $05,$05,$05,$05,$05,$05,$01,$03,$05,$01,$05,$05,$01,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$01,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$01,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$01,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$02,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$01,$05,$05,$01,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$02,$05,$05,$02,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

bkg02:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

bkg03:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

bkg04:
   .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
   .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
   .db $01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$01,$01,$01,$01,$01,$01,$01,$01,$05,$05,$05,$01
   .db $02,$05,$05,$05,$01,$02,$02,$01,$01,$02,$02,$01,$05,$05,$05,$01
   .db $05,$05,$05,$05,$02,$05,$05,$01,$01,$05,$05,$02,$05,$05,$05,$01
   .db $05,$05,$05,$05,$05,$05,$05,$02,$02,$05,$05,$05,$05,$05,$05,$01
   .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
   .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
   .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
   .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
   .db $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

;;;;;;;;;;;;;;;;;;;;;;
;;;   SECOND ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;;

bkg10:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$01
    .db $01,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$03,$03,$03,$04,$05,$05,$04,$04,$04,$04,$04,$04,$02
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg11:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$06,$06,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$02
    .db $06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06
    .db $06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06
    .db $06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06
    .db $01,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$01
    .db $01,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$06,$06,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$06,$06,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg12:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$07,$07,$02,$02,$02,$02,$02,$02,$01
    .db $01,$06,$06,$06,$06,$06,$06,$07,$07,$06,$06,$06,$06,$06,$06,$01
    .db $01,$06,$06,$06,$06,$06,$06,$07,$07,$06,$06,$06,$06,$06,$06,$01
    .db $02,$06,$06,$06,$06,$06,$06,$07,$07,$06,$06,$06,$06,$06,$06,$02
    .db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    .db $07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    .db $07,$07,$07,$03,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07
    .db $01,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$07,$01
    .db $01,$06,$06,$06,$06,$06,$06,$07,$07,$06,$03,$06,$06,$06,$06,$01
    .db $01,$06,$06,$06,$06,$06,$06,$07,$07,$06,$06,$06,$06,$06,$06,$01
    .db $02,$06,$06,$06,$06,$06,$06,$07,$07,$06,$06,$06,$06,$06,$06,$02
    .db $02,$02,$02,$02,$02,$02,$02,$07,$07,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg13:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$04,$04,$02,$02,$02,$02,$02,$02,$01
    .db $01,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$01
    .db $01,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$01
    .db $02,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$01
    .db $04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$01
    .db $01,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$01
    .db $02,$07,$07,$07,$07,$07,$07,$04,$04,$07,$07,$07,$07,$07,$07,$02
    .db $02,$02,$02,$02,$02,$02,$02,$04,$04,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

;;;;;;;;;;;;;;;;;;;;;
;;;   THIRD ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;

bkg20:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$02
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$05
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$04,$04,$04,$04,$04,$04,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg21:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$04,$04,$04,$04,$04,$04,$04,$04,$05,$05,$05,$01
    .db $02,$05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05,$02
    .db $05,$05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05,$05
    .db $05,$05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05,$05
    .db $05,$05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05,$05
    .db $01,$05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05,$01
    .db $01,$05,$05,$05,$04,$05,$05,$05,$05,$05,$03,$04,$05,$05,$05,$01
    .db $01,$05,$05,$05,$04,$04,$04,$04,$04,$04,$04,$04,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg22:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$05,$05,$01
    .db $02,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$02
    .db $05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05
    .db $05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05
    .db $05,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$05
    .db $01,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$01
    .db $01,$05,$05,$04,$05,$05,$05,$05,$05,$05,$05,$05,$04,$05,$05,$01
    .db $01,$05,$05,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$02,$02,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg23:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$05,$05,$02,$02,$02,$02,$02,$02,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $01,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$01
    .db $02,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$05,$02
    .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

;;;;;;;;;;;;;;;;;;;;;;
;;;   FOURTH ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;;

bkg30:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$04,$04,$02,$02,$02,$02,$02,$02,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$00,$04,$04,$04,$04,$00,$04,$04,$04,$04,$02
    .db $01,$04,$04,$04,$04,$04,$00,$04,$04,$00,$04,$04,$04,$04,$04,$05
    .db $01,$04,$04,$04,$04,$04,$04,$00,$00,$04,$04,$04,$04,$04,$04,$05
    .db $01,$04,$04,$04,$04,$04,$04,$00,$00,$04,$04,$04,$04,$04,$04,$05
    .db $01,$04,$04,$04,$04,$04,$00,$04,$04,$00,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$00,$04,$04,$04,$04,$00,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$02
    .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg31:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$04,$04,$02,$02,$02,$02,$02,$02,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$05,$04,$04,$04,$04,$05,$04,$04,$04,$04,$02
    .db $05,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$05
    .db $05,$04,$04,$04,$04,$04,$05,$00,$00,$05,$04,$04,$04,$04,$04,$05
    .db $05,$04,$04,$04,$04,$04,$05,$00,$00,$05,$04,$04,$04,$04,$04,$05
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$05,$04,$04,$04,$04,$05,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$02
    .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg32:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$08,$08,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$04,$04,$02,$02,$02,$02,$02,$02,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$05,$04,$04,$04,$04,$04,$04,$05,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$05,$04,$04,$04,$04,$05,$04,$04,$04,$04,$02
    .db $05,$04,$04,$04,$04,$04,$05,$04,$04,$05,$04,$04,$04,$04,$04,$05
    .db $05,$04,$04,$04,$04,$04,$04,$00,$00,$04,$04,$04,$04,$04,$04,$05
    .db $05,$04,$04,$04,$04,$04,$04,$00,$00,$04,$04,$04,$04,$04,$04,$05
    .db $01,$04,$04,$04,$04,$04,$05,$04,$04,$05,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$05,$04,$04,$04,$04,$05,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$05,$04,$04,$04,$04,$04,$04,$05,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$02
    .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01

bkg33:
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
    .db $01,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$01
    .db $01,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$05,$04,$04,$04,$04,$04,$04,$05,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$05,$04,$04,$04,$04,$05,$04,$04,$04,$04,$01
    .db $05,$04,$04,$04,$04,$04,$05,$04,$04,$05,$04,$04,$04,$04,$04,$01
    .db $05,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $05,$04,$04,$04,$04,$04,$04,$05,$05,$04,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$04,$05,$04,$04,$05,$04,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$04,$05,$04,$04,$04,$04,$03,$04,$04,$04,$04,$01
    .db $01,$04,$04,$04,$05,$04,$04,$04,$04,$04,$04,$05,$04,$04,$04,$01
    .db $02,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$04,$02
    .db $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
    .db $08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08,$08
    .db $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01


;;;;;;;;;;;;;;;;;;;;;
;;;   FIRST ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;

atb00:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010000, %01010000,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %00000000,%00000000, %00000000,%00000000, %01010101,%00010001
    .db %01000100,%01010101, %01010100,%00010001, %01000100,%01010001, %01010101,%01010101

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb01:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01000000, %01010000,%01010000, %00000000,%00000000

    .db %01000100,%01010101, %01010101,%01000100, %00010101,%01010101, %00000000,%00000000
    .db %01010101,%01010101, %01010101,%01000100, %00010001,%01010101, %01000100,%01010101

    .db %01000101,%01010101, %01010101,%01000100, %00010001,%01010101, %01000100,%00010101
    .db %01000100,%01010101, %01010101,%01000100, %00010001,%01010101, %01010100,%00010001

    .db %00000100,%00000101, %00000101,%01000100, %00010001,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb02:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010000, %01010000,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb03:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010000, %01010000,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000
    
atb04:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010000, %01010000,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %00000000,%00000000, %00000000,%00000000, %01010101,%00010001
    .db %01010101,%01010101, %01010100,%00010001, %01000100,%01010001, %01010101,%00010001

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000
    
;;;;;;;;;;;;;;;;;;;;;;
;;;   SECOND ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;;
    
atb10:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb11:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb12:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000


atb13:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000
    
;;;;;;;;;;;;;;;;;;;;;
;;;   THIRD ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;
    
atb20:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb21:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb22:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%01000101, %00010101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb23:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000
    
;;;;;;;;;;;;;;;;;;;;;;
;;;   FOURTH ROW   ;;;
;;;;;;;;;;;;;;;;;;;;;;
    
atb30:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb31:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

atb32:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%01000000, %00010000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010100, %01010001,%01010000, %01010000,%00010000
                                                                                          
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%01010101
                                                                                          
    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010101
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
                                                                                          
    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000


atb33:  ; per byte:  bottom (right-left) <--> top (right-left)
    .db %00000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00000000
    .db %01000000,%01010000, %01010000,%01010000, %01010000,%01010000, %01010000,%00010000

    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01010101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %01000101,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001
    .db %01000100,%01010101, %01010101,%01010101, %01010101,%01010101, %01010101,%00010001

    .db %00000100,%00000101, %00000101,%00000101, %00000101,%00000101, %00000101,%00000001
    .db %01000000,%00000000, %00000000,%00000000, %00000000,%00000000, %00000000,%00010000

    .pad $C000


;;;;;;;;;;;;;;;;;;;;
;;;              ;;;
;;;   BANK ONE   ;;;
;;;              ;;;
;;;;;;;;;;;;;;;;;;;;

    .base $8000
    
    .include "textEngine.asm"

    .pad $C000

;;;;;;;;;;;;;;;;;;;;
;;;              ;;;
;;;   BANK TWO   ;;;
;;;              ;;;
;;;;;;;;;;;;;;;;;;;;

    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;
;;;                ;;;
;;;   BANK THREE   ;;;
;;;                ;;;
;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;
;;;               ;;;
;;;   BANK FOUR   ;;;
;;;               ;;;
;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;
;;;               ;;;
;;;   BANK FIVE   ;;;
;;;               ;;;
;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;
;;;                ;;;
;;;   BANK SEVEN   ;;;
;;;                ;;;
;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;
;;;                ;;;
;;;   BANK EIGHT   ;;;
;;;                ;;;
;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;
;;;               ;;;
;;;   BANK NINE   ;;;
;;;               ;;;
;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;
;;;              ;;;
;;;   BANK TEN   ;;;
;;;              ;;;
;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;;
;;;                 ;;;
;;;   BANK ELEVEN   ;;;
;;;                 ;;;
;;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;;
;;;                 ;;;
;;;   BANK TWELVE   ;;;
;;;                 ;;;
;;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;;;;
;;;                   ;;;
;;;   BANK THIRTEEN   ;;;
;;;                   ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;;;;
;;;                   ;;;
;;;   BANK FOURTEEN   ;;;
;;;                   ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
;    .pad $C000

;;;;;;;;;;;;;;;;;;;;;;;;
;;;                  ;;;
;;;   BANK FIFTEEN   ;;;
;;;                  ;;;
;;;;;;;;;;;;;;;;;;;;;;;;

;    .base $8000
    .pad $C000
;;;;;;;;;;;;;;;;;
;;;   RESET   ;;;
;;;;;;;;;;;;;;;;;

RESET:
    sei
    cld
    lda #$40
    sta $4017
    ldx #$FF
    txs
    stx MAP_Control
    inx
    stx PPU_Control
    stx PPU_Mask
    stx $4010

vblank1:
    bit PPU_Status
    bpl vblank1

clrmem:
    lda #$00
    sta $0000,x
    sta $0100,x
    sta $0300,x
    sta $0400,x
    sta $0500,x
    sta $0600,x
    sta $0700,x
    sta $6000,x
    sta $6100,x
    sta $6200,x
    sta $6300,x
    lda #$FE
    sta $0200,x
    inx
    bne clrmem

vblank2:
    bit PPU_Status
    bpl vblank2
    
    lda #%00011110
    jsr setMapperControl

    lda #%00000000
    jsr setMapperCHR0
    
    lda #%00000001
    jsr setMapperCHR1

    lda #%00000000
    jsr setMapperPRG

loadSprite1:
    ldx #$00
@loop:
    lda sprite1,x
    sta spriteRAM,x
    inx
    cpx #$14
    bne @loop
loadSprite1done:

loadPalettes:
    lda PPU_Status
    lda #$3F
    sta PPU_Address
    lda #$00
    sta PPU_Address

    ldx #$00
@loop:
    lda palette,x
    sta PPU_Data
    inx
    cpx #$20
    bne @loop
loadPalettesDone:

loadNametable:
    lda #$01
    sta needDraw
loadNametableDone:

    jsr loadFlags

    lda #%10010000
    sta softPPU_Control
    sta PPU_Control
    lda #%00011110
    sta softPPU_Mask
    sta PPU_Mask
    
    lda #$00
    sta secs
    lda #$00
    sta mins
    lda #$0C
    sta hrs

    lda #$7C
    sta playerX
    lda #$80
    sta playerY
    
    lda #$07
    sta textCounter
    
    lda #$00
    sta gameState
    lda #$08
    sta textSpeed
    lda #$61
    sta textAddrL
    lda #$20
    sta textAddrH
    
    lda #$00
    jsr setMapperPRG
    
    lda #$01
    sta playerSpeed

    jmp MAIN

timeKeeping:
    inc tick
    lda tick
    cmp #$3C
    beq seconds
    bvc timeKeepingDone
seconds:
    lda #$00
    sta tick
    inc secs
    lda secs
    cmp #$3C
    beq minutes
    bvc timeKeepingDone
minutes:
    lda #$00
    sta secs
    inc mins
    lda mins
    cmp #$3C
    beq hours
    bvc timeKeepingDone
hours:
    lda #$00
    sta mins
    inc hrs
    lda hrs
    cmp #$0D
    bne timeKeepingDone
    lda #$01
    sta hrs
timeKeepingDone:
    rts
    
setMapperControl:
    sta MAP_Control
    lsr A
    sta MAP_Control
    lsr A
    sta MAP_Control
    lsr A
    sta MAP_Control
    lsr A
    sta MAP_Control
setMapperControlDone:
    rts
    
setMapperCHR0:
    sta MAP_CHR0
    lsr A
    sta MAP_CHR0
    lsr A
    sta MAP_CHR0
    lsr A
    sta MAP_CHR0
    lsr A
    sta MAP_CHR0
setMapperCHR0done:
    rts
    
setMapperCHR1:
    sta MAP_CHR1
    lsr A
    sta MAP_CHR1
    lsr A
    sta MAP_CHR1
    lsr A
    sta MAP_CHR1
    lsr A
    sta MAP_CHR1
setMapperCHR1done:
    rts
    
setMapperPRG:
    sta MAP_PRG
    lsr A
    sta MAP_PRG
    lsr A
    sta MAP_PRG
    lsr A
    sta MAP_PRG
    lsr A
    sta MAP_PRG
setMapperPRGdone:
    rts
    
;;;;;;;;;;;;;;;;;;;;
;;;   INCLUDES   ;;;
;;;;;;;;;;;;;;;;;;;;

    .include "background&items.asm"

    .include "input.asm"

    .include "collision.asm"

    .include "animation.asm"
    
;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;   MAIN INDIRECTION   ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;

mainStatesL:
    .dl blank-1
    .dl playingMAIN-1
    .dl textBoxMAIN-1
mainStatesH:
    .dh blank-1
    .dh playingMAIN-1
    .dh textBoxMAIN-1

mainIndirect:
    ldx gameState

    lda mainStatesH,x
    pha
    lda mainStatesL,x
    pha

    lda prgNo
    cmp prgNoOld
    beq mainIndirectDone
    sta prgNoOld
    jsr setMapperPRG
mainIndirectDone:
    rts

playingMAIN:
    lda playerDir
    sta playerDirOld

    jsr updateSpriteLoc
    jsr updatePlayerCol

readInput:
    jsr readRight
    jsr readLeft
    jsr readDown
    jsr readUp
    jsr readB
    jsr readA
readInputDone:

processInput:
    jsr moveRight
    jsr moveLeft
    jsr moveDown
    jsr moveUp
processInputDone:

    jsr updateFrames
playingMAINdone:
    rts

textBoxMAIN:
    ldx textIndirect

    lda textMAINindH,x
    pha
    lda textMAINindL,x
    pha

    rts

    fillTextBuffer:
        jsr lookupMessage
        inc textIndirect
    fillTextBufferDone:
        rts

    speedUp:
        lda buttons
        and #%10000000
        beq speedUpDone

        lda #$01
        cmp textSpeed
        beq speedUpDone

        sta textSpeed
    speedUpDone:
        rts

    advanceTB:
        lda buttons
        and #%10000000
        beq advanceTBdone

        lda oldButtons
        and #%10000000
        bne advanceTBdone

        lda #$05
        sta textIndirect
        lda #$00
        sta stringCtr
        sta textCounter
    advanceTBdone:
        rts

    startNewLine:
        inc lineNo
        ldx lineNo
        lda textLine,x
        sta textAddrL
        inc stringCtr
        lda #$02
        sta textIndirect
    startNewLineDone:
        rts
textBoxMAINdone:


;;;;;;;;;;;;;;;;;;;;;;;;;
;;;   NMI INDIRECTS   ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;

nmiStatesL:
    .dl blank-1
    .dl blank-1
    .dl textBoxNMI-1
nmiStatesH:
    .dh blank-1
    .dh blank-1
    .dh textBoxNMI-1

nmiIndirect:
    ldx gameState

    lda nmiStatesH,x
    pha
    lda nmiStatesL,x
    pha

    lda prgNo
    cmp prgNoOld
    beq nmiIndirectDone
    sta prgNoOld
    jsr setMapperPRG
nmiIndirectDone:
    rts

textBoxNMI:
    ldx textIndirect

    lda textNMIindH,x
    pha
    lda textNMIindL,x
    pha
    rts

    drawTB:
        lda textCounter
        cmp #$07
        bne @skip
        lda #$01
        sta textIndirect
        rts

    @skip
        jsr drawTextBox

        lda needTextAttrib
        beq textBoxNMIdone
        jsr drawTextAttrib
    drawTBdone:
        rts

    writeString:
        jsr readStringBuff
    writeStringDone:
        rts
        
    restoreBkg:
        lda textCounter
        cmp #$07
        bne @skip
        lda #$01
        sta gameState
        rts

    @skip
        jsr restorePPUbuffer

        lda needTextAttrib
        beq textBoxNMIdone
        jsr restoreTextAttrib
    restoreBkgDone:
        rts

textBoxNMIdone:


blank:
    rts

textMAINindL:
    .dl blank-1
    .dl fillTextBuffer-1
    .dl speedUp-1
    .dl advanceTB-1
    .dl startNewLine-1
    .dl blank-1
textMAINindH:
    .dh blank-1
    .dh fillTextBuffer-1
    .dh speedUp-1
    .dh advanceTB-1
    .dh startNewLine-1
    .dh blank-1

textNMIindL:
    .dl drawTB-1
    .dl blank-1
    .dl writeString-1
    .dl blank-1
    .dl blank-1
    .dl restoreBkg-1
textNMIindH:
    .dh drawTB-1
    .dh blank-1
    .dh writeString-1
    .dh blank-1
    .dh blank-1
    .dh restoreBkg-1

;;;;;;;;;;;;;;;;
;;;   MAIN   ;;;
;;;;;;;;;;;;;;;;

    .align $100

MAIN:
    inc sleeping        ; MAIN jumps here after one iteration. Increments sleeping so loop is active.
loop:
    lda sleeping		; Do-nothing routine. NMI returns here with sleeping set to 0.
    bne loop

    jsr mainIndirect

showCPUusageBar:
    ldx #%00011111  	; sprites + background + monochrome (i.e. WHITE)
    stx $2001
    ldy #$08  			; add about 23 for each additional line (leave it on WHITE for one scan line)
-   dey
    bne -
    dex    				; sprites + background + NO monochrome  (i.e. #%00011110)
    stx $2001

    jmp MAIN

;;;;;;;;;;;;;;;
;;;   NMI   ;;;
;;;;;;;;;;;;;;;

NMI:
    pha
    txa
    pha
    tya
    pha

    lda #$00
    sta $2003
    lda #$02
    sta $4014

drawBkgRoutine:
    lda needDraw
    beq NMIroutine

    jsr drawBkg

    jmp NMIend

NMIroutine:
    jsr nmiIndirect

frame:
    inc frameCounter
    lda frameCounter
    cmp #$30
    bne frameDone
    and #$00
    sta frameCounter
frameDone:

    jsr latchController

    lda #$00
    sta PPU_Address
    sta PPU_Address
    sta PPU_Scroll
    sta PPU_Scroll

    lda softPPU_Control
    sta PPU_Control
    lda softPPU_Mask
    sta PPU_Mask
    dec sleeping

NMIend:
    pla
    tay
    pla
    tax
    pla
    rti

;;;;;;;;;;;;;;;;;;;
;;;   VECTORS   ;;;
;;;;;;;;;;;;;;;;;;;

    .pad $FFFA

    .dw NMI
    .dw RESET
    .dw 0
    
;;;;;;;;;;;;;;;;;;;
;;;   CHR-ROM   ;;;
;;;;;;;;;;;;;;;;;;;

    .incbin "screenchange&sprite.chr"
    .incbin "META.chr"
